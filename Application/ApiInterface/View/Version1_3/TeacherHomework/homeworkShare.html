<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
		<meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
		<title>作业报告</title>
	    <script src="http://apps.bdimg.com/libs/jquery/1.10.1/jquery.js" type="text/javascript"></script>
	    <script type="text/javascript" src="__PUBLIC__/adminExercise/js/vue.js"></script>
		<script type="text/javascript" src="__PUBLIC__/adminExercise/js/vue-resource.min.js"></script>
		<script src="https://lkme.cc/js/linkedme.min.js" ></script>
		<style>
			*{
				margin: 0;
				padding: 0;
			}
			html,body{
				background: #eee;
				font-size: 16px;
				color: #333
			}
			body{
				padding:5px 10px;
				padding-bottom: 60px;
			}
			ul li{
				list-style: none
			}
			.top{
				background: #fff url(__PUBLIC__/img/Apphomework/fengexian.png) no-repeat bottom;
				background-size: 100% 10px;
				overflow: hidden;
				padding-bottom: 10px
			}
			.color999{
				color: #999
			}
			.top p{
				text-align: center;
				position: relative;
				font-size: 20px;
				line-height: 36px
			}
			.w50{
				width: 50%;
				box-sizing: border-box;
			}
			.border-right{
				border-right: 1px solid #eee
			}
			.top p img{
				position: absolute;
				width: 20px;
				top: 8px
			}
			.text-center{
				text-align: center;
			}
			.left{
				float: left;
			}
			.img100{
				width: 100%;
				display: block;
			}
			.timeDiv{
				line-height: 26px;
				margin-top: 20px
			}
			.timeDiv img{
				position: relative;
				top:3px;
				width: 18px;
				left: -5px
			}
			.bang,.exercise{
				padding: 15px 0 ;
				background: #fff url(__PUBLIC__/img/Apphomework/fengexian.png) no-repeat bottom;
				background-size: 100% 10px;
			}
			.student{
				background: #fff;
				padding: 15px 10px
			}
			.bang p,.exercise .text-center,.student .text-center{
				line-height: 26px;
				font-size: 18px;
				color: #6b400d;
				font-weight: bold;

			}
			.bang div{
				margin:10px 20px ;
				border-radius: 8px;
				border: 1px solid #6b400d;
				padding: 15px 20px
			}
			.bang div span{
				display: inline-block;
				text-align: center;
			}
			.bang div span:nth-child(1){
				width: 32%;
			}
			.bang div span:nth-child(2){
				width: 29%;
			}
			.bang div span:nth-child(3){
				width: 34%;
			}
			.name{
				width: 80px;
				display: inline-block;
				text-align-last: justify;
			}
			.studentName{
				display: inline-block;
				padding:0px 4px;
				margin: 0 5px;
				border: 1px solid #6b400d;
				border-radius: 8px
			}
			.yellowBtn {
				    background: #f2b81a;
				}
			.bottomBtn {
			    width: 100%;
			    height: 50px;
			    line-height: 50px;
			    text-align: center;
			    border-top: 1px solid #eee;
			    position: fixed;
			    left: 0;
			    bottom: 0;
			}
			.content{
				padding: 10px;
				text-align: justify;
			}
			.color6b{
				color: #6b400d;
			}
			.mask{
				background: #000;
				opacity: 0.6;
				position: fixed;
				top:0;
				left: 0;
				height:100%;
				z-index: 2;
				width:100%;
				display: none
			}
			.mask img{
				width: 100%
			}
			.bottomBtn a{
				color: #333;
				text-decoration: none
			}
		</style>
	</head>
	<body>
		<div id="app">
			<div class="">
				<img src="__PUBLIC__/img/Apphomework/dingbu.png" alt="" / class="img100">
			</div>
			<div class="top">
				<p>
					<b>{{workName}}</b>&nbsp;&nbsp;
					<img v-if='course_id  == 1' src="{$oss_path}public/web_img/App/DirectTrain/yuwen@2x.png" alt=""  >
					<img v-if='course_id  == 2' src="{$oss_path}public/web_img/App/DirectTrain/shuxue@2x.png" alt=""  >
					<img v-if='course_id == 3' src="{$oss_path}public/web_img/App/DirectTrain/yingyu@2x.png" alt=""  >
					<img v-if='course_id == 4' src="{$oss_path}public/web_img/App/DirectTrain/wuli@2x.png" alt=""  >
					<img v-if='course_id  == 5' src="{$oss_path}public/web_img/App/DirectTrain/huaxue@2x.png" alt=""  >
					<img v-if='course_id == 6' src="{$oss_path}public/web_img/App/DirectTrain/si@2x.png" alt=""  >
					<img v-if='course_id  == 7' src="{$oss_path}public/web_img/App/DirectTrain/lishi@2x.png" alt=""  >
					<img v-if='course_id  == 8' src="{$oss_path}public/web_img/App/DirectTrain/dili@2x.png" alt=""  >
					<img v-if='course_id  == 9' src="{$oss_path}public/web_img/App/DirectTrain/shengwu@2x.png" alt=""  >
					<img v-if='course_id== 11' src="{$oss_path}public/web_img/App/DirectTrain/meishu@2x.png" alt=""  >
					<img v-if='course_id == 12' src="{$oss_path}public/web_img/App/DirectTrain/tiyu@2x.png" alt=""  >
					<img v-if='course_id  == 17' src="{$oss_path}public/web_img/App/DirectTrain/laoji@2x.png" alt=""  >
					<img v-if='course_id == 31' src="{$oss_path}public/web_img/App/DirectTrain/kexue@2x.png" alt=""  >
					<img v-if='course_id  == 37' src="{$oss_path}public/web_img/App/DirectTrain/yinyue@2x.png" alt=""  >
				</p>
				<div class="color999 text-center">
					{{teacher}}布置 总分{{total_score}}分
				</div>
				<div class="left w50 text-center border-right timeDiv">
					{{avg_time}}
					<br>
					<img src="__PUBLIC__/img/Apphomework/yongshi.png" alt="" /><span class="color999">平均用时</span>
				</div>
				<div class="left w50 text-center timeDiv">
					{{avg_total_score}}
					<br>
					<img  src="__PUBLIC__/img/Apphomework/pingjun.png" alt="" /><span class="color999">作业平均分数</span>
				</div>
			</div>
			<div class="bang">
				<p class="text-center">
					<img src="__PUBLIC__/img/Apphomework/zuo.png" alt="" />
					成绩优秀榜
					<img src="__PUBLIC__/img/Apphomework/you.png" alt="" />
				</p>
				<div class="">
					<ul>
						<li v-for="list in excellent_student_list" :id="list.student_id">
							<span>{{list.student_name}}</span>
							<span>{{list.total_score}}分</span>
							<span>{{list.work_timeout}}s</span>
						</li>

					</ul>
				</div>
			</div>
			<div class="exercise">
				<p class="text-center">
					<img src="__PUBLIC__/img/Apphomework/zuo.png" alt="" />
						作业错题详情
					<img src="__PUBLIC__/img/Apphomework/you.png" alt="" />
				</p>
				<div class="content" v-for="(list,index) in error_list">
					<p>
						{{index+1}}  {{list.top_name}} ({{list.count_score}}分)
					</p>
					<p v-html="list.subject_name">

					</p>
					<p v-html="list.answer">

					</p>
					<p>
						<b class="color6b">错误率</b>：{{list.error_rate}}
					</p>
				</div>
			</div>
			<div class="student">
				<p class="text-center">
					<img src="__PUBLIC__/img/Apphomework/zuo.png" alt="" />
					待提高同学
					<img src="__PUBLIC__/img/Apphomework/you.png" alt="" />
				</p>
				<p style="margin-top:10px">
					<span class="name">截止后提交</span>:<span class="studentName" v-for="list in end_time_student_list" :id="list.id">{{list.student_name}}</span>
				</p>
				<p  style="margin-top:10px">
					<span class="name">未提交</span>:<span class="studentName" v-for="list in unsubmit_student_list":id="list.id">{{list.student_name}}</span>
				</p>
			</div>
			<div class="bottomBtn yellowBtn">
				<a href="javascript:" class="openadd linkedme">打开京版云</a>
				<input type="hidden" value="{$urldata}" class="url">
			</div>
			<div class="mask" @click="maskHide">
				<img src="{$oss_path}public/web_img/App/arrows.png" alt="" />
			</div>
		</div>


	</body>
	<script type="text/javascript" src="__PUBLIC__/js/notify/notifyApp.js"></script>
	<script>
		var oss_path = "{$oss_path}";
		var app = new Vue({
			el: '#app',
			data: {
				dataUrl:'/index.php/ApiInterface/Version1_3/TeacherHomework/getWorkReport',
				detailsData:[],
				workName:'',//作业名称
				teacher:'',//布置人
				total_score:'',//总分
				avg_total_score:'',//平均得分
				avg_time:'',//平均用时
				excellent_student_list:[],//优秀榜
				error_list:[],//错题
				end_time_student_list:[],//截止后提交,
				unsubmit_student_list:[],//未提交
				course_id:'',//学科
			},
			created: function () { //应用初始化完毕加载
				this.dataList()
			},
			methods: {
				dataList:function(){
					this.$http.post(this.dataUrl, {
						homeworkId: 511,
						classId: 934,

					}, {
						emulateJSON: 'application/x-www-form-urlencoded'
					}).then(function (response) {
						if(response.status == '200'){
							console.log(response.data.data);
							this.workName = response.data.data.name;
							this.teacher = response.data.data.create_user_name;
							this.total_score = response.data.data.total_score;
							this.avg_total_score = response.data.data.avg_total_score;
							this.avg_time =  response.data.data.avg_time;
							this.excellent_student_list = response.data.data.excellent_student_list;
							this.error_list = response.data.data.error_list;
							this.end_time_student_list = response.data.data.end_time_student_list;
							this.unsubmit_student_list = response.data.data.unsubmit_student_list;
							this.course_id = response.data.data.course_id;
						} else {
							console.log('错误1')
						}
					}, function (response) {
						console.log('错误2')
					})
				},
				mask:function(){
					$('.mask').show();
					$('body').css('overflow','hidden')
				},
				maskHide:function(){
					$('.mask').hide();
					$('body').css('overflow','auto')
				}
			}
		})
	</script>


	<script>

		var url = $('.url').val();
		linkedme.init("fd65bd508366dff5336015e5db872def", {type: "live"}, null);
		var data = {};
		data.type = "live";  //表示现在使用线上模式,如果填写"test", 表示测试模式.【可选】
		data.feature = "功能名称"; // 自定义深度链接功能，多个用逗号分隔，【可选】
		data.stage = "阶段名称"; // 自定义深度链接阶段，多个用逗号分隔，【可选】
		data.channel = "渠道名称"; // 自定义深度链接渠道，多个用逗号分隔，【可选】
		data.tags = "标签名称"; // 自定义深度链接标签，多个用逗号分隔，【可选】
		data.ios_custom_url = ""; // 自定义iOS平台下App的下载地址，如果是AppStore的下载地址可以不用填写，【可选】
		data.android_custom_url = "";// 自定义安卓平台下App的下载地址，【可选】
		// 下面是自定义深度链接参数，用户点击深度链接打开app之后，params参数将被带入app
		// 比如详情页面的参数，可以写进去，这样唤起app后可直接跳转到详情页【可选】
		var value1 = 1;
		var value2 = 2;
		data.params = '{"url":"'+url+'","key2":"'+value2+'"}'; //注意单引号和双引号的位置

		linkedme.link(data, function(err, data){
			if(err){
				// 生成深度链接失败，返回错误对象err
				alert('生成错误');
			} else {
				/*
				 生成深度链接成功，深度链接可以通过data.url得到，
				 将深度链接绑定到<a>标签，这样当用户点击这
				 个深度链接，如果是在pc上，那么跳转到深度链接二维
				 码页面，用户用手机扫描该二维码就会打开app；如果
				 在移动端，深度链接直接会根据手机设备类型打开ios
				 或者安卓app
				 */
				$('.openadd').attr('url-data',data.url);
				//document.body.innerHTML += '<a class="linkedme" href="'+data.url+'">打开app</a>'
			}
		},false);

		$('.shareMask').click(function(){
			$('.notifyBox').show();
		});


		$('.notifyBtn').click(function(){
			$('.notifyBox').hide();
		})

		$('.openadd').click(function(){
			$(this).css('color','#fff');
			var url = $(this).attr('url-data');
			window.location.href = url;//跳到生成的深度链接的url
		});
	</script>
</html>
