<layout name="teacher_layout_1"/>
<link href="__PUBLIC__/css/directTrainList.css" rel="stylesheet" type="text/css"/>
<link href="__PUBLIC_METRO__/css/app/table_list1.css?v=2.0" type="text/css" rel="stylesheet">
<style media="screen">
	.searchList li{
		margin-left: 10px
	}
	.indexBox{
		margin-top: 10px !important
	}
</style>

<div>
    <a href="javascript:window.history.go(-1)" title="返回" class="btn btnReturn1">返回</a>
</div>
<div class="search">
	<button class="search_btn">搜索</button>
	<input type="text" name="" value="<?php echo $keyword?>" class="search_text" placeholder="">
</div>
<div class="text-center mt10">
	京版云为您找到'<?php echo $keyword?>'结果<?php echo $count?>个
</div>
<div class="indexBox mt20">
	<div class="leftNav left">
		<ul>
			<li>
				<span class="navSort">筛选</span>

			</li>
			<?php foreach($course_list as $k=>$itemCource){?>
			<li>

				<span class="navSubject" attr-value="<?php echo $itemCource?>" ><?php echo $k?></span>
				<div class="navBox">
					<ul class="m0 p20">
						<li>
							<p class="fz18">
								<b>年级</b>
							</p>
							<p class="of grade">
								<?php foreach($grade_list as $itemGrade){?>
								<span attr-value="<?php echo $itemGrade['id']?>"><?php echo $itemGrade['name']?></span>
								<?php }?>
							</p>
							<p class="fz18">
								<b>分册</b>
							</p>
							<p class="of fascicule">
								<span attr-value="1" >上册</span>
								<span attr-value="2" >下册</span>
								<span attr-value="3" >全一册</span>
							</p>
							<p class="fz18">
								<b>讲授人</b>
							</p>
							<p class="of editor">
								<?php foreach($editors_list as $itemEditors){?>
								<span attr-value="<?php echo $itemEditors['teacher_id']?>"><?php echo $itemEditors['name']?></span>
								<?php }?>
							</p>
							<p class="text-center">
								<button type="button" name="button" class="determine">确定</button>
							</p>
						</li>
					</ul>
				</div>


			</li>
				<?php }?>
		</ul>
	</div>
	<div class="searchIframe" style="width:1130px">
		<div class="searchBox of">
			<ul class="of">
				<li class="sort" name="isDefault">默认</li>
				<li class="sort" name="isNew">最新</li>
				<li class="sort" name="isHot">人气</li>
				<li class="sort" name="isPrice">价格</li>
				<li><input type="radio" name="isGratis" value="" class="free">免费</li>
				<li><input type="radio" name="isToll" value="" class="charge">收费</li>
				<li><input type="radio" name="isPurchased" value="" class="purchased">已购买</li>
			</ul>
		</div>
		<div class="searchList of">
			<!-- include  取下面这个UL-->
			<!--<ul>
				<?php foreach($column_list as $itemColumn){?>
					<?php if($itemColumn['type'] == SPECIAL_COLUMN){?>
				&lt;!&ndash;这是栏目&ndash;&gt;
				<li>
					<a href="index.php?m=Home&c=DirectTrain&a=specialColumnDetails&id=<?php echo $itemColumn['id']?>" class="searchBoxList">
						<div class="text-center mt20">
							<p class="subject">
								<?php if($itemColumn['code'] == 'yw'){?>
								<img src="__PUBLIC__/img/directTrain/yuwen.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'SX'){?>
								<img src="__PUBLIC__/img/directTrain/shuxue.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'YY'){?>
								<img src="__PUBLIC__/img/directTrain/yingyu.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'WL'){?>
								<img src="__PUBLIC__/img/directTrain/wuli.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'HX'){?>
								<img src="__PUBLIC__/img/directTrain/huaxue.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'ZZ'){?>
								<img src="__PUBLIC__/img/directTrain/sixiangzhengzhi.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'LS'){?>
								<img src="__PUBLIC__/img/directTrain/lishi.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'DL'){?>
								<img src="__PUBLIC__/img/directTrain/di.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'SW'){?>
								<img src="__PUBLIC__/img/directTrain/shengwu.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'MS'){?>
								<img src="__PUBLIC__/img/directTrain/meishu.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'TYJK'){?>
								<img src="__PUBLIC__/img/directTrain/tiyujiankang.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'LDJS'){?>

								<?php }elseif($itemColumn['code'] == 'XXJS'){?>

								<?php }elseif($itemColumn['code'] == 'YJPJ'){?>

								<?php }elseif($itemColumn['code'] == 'kx'){?>
								<img src="__PUBLIC__/img/directTrain/kexue.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'QXK'){?>

								<?php }elseif($itemColumn['code'] == 'PDYSH'){?>

								<?php }elseif($itemColumn['code'] == 'SXPD'){?>

								<?php }elseif($itemColumn['code'] == 'SXZZ'){?>
								<img src="__PUBLIC__/img/directTrain/sixiangzhengzhi.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'YX'){?>
								<img src="__PUBLIC__/img/directTrain/yin.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'SF'){?>

								<?php }elseif($itemColumn['code'] == 'TYJS'){?>
								<img src="__PUBLIC__/img/directTrain/tongyongjishu.png" alt="" /class="mr5 top1">
								<?php }?>
								<?php echo $itemColumn['course_name'].$itemColumn['grade'];?>
								<?php if($itemColumn['fascicule_id'] == 1){?>
								上册
								<?php }elseif($itemColumn['fascicule_id'] == 2){?>
								下册
								<?php }else{?>
								全一册
								<?php }?>
							</p>
						</div>
						<p class="searchTitle">
							<?php echo $itemColumn['special_column_question_title']?>
						</p>
						<p class="watch of">
							<span class="left ml10">已有：<?php echo $itemColumn['special_column_question_visit_count']?>人观看</span>
							<?php if($itemColumn['special_column_price'] > 0){?>
								<?php if($vip == 'vip'){?>
							会员免费
								<?php }elseif(!is_null($itemColumn['order_sn'])){?>
							已购买
								<?php }else{?>
								<span class="right mr10 colorred"><img src="__PUBLIC__/img/directTrain/shi.png" alt="" /><?php echo $itemColumn['special_column_price']?></span>
								<?php }?>
							<?php }else{ ?>
							<span class="right mr10 "><img src="__PUBLIC__/img/directTrain/shi.png" alt="" />免费</span>
							<?php }?>
						<p class="color666 text-center">
							时间：<?php echo $itemColumn['putaway_status_time']?>
						</p>
						<p class="text-center headPortrait">
							<img src="<?php echo !empty($itemColumn['avatar']) ?  $oss_path.$itemColumn['avatar'] : '/Public/img/classManage/teacher_m.png'?>" alt="" / >
						</p>
						<p class="text-center color666">
							<img src="__PUBLIC__/img/resource/ppt.png" alt="" />  讲授人:<?php echo $itemColumn['name']?>
						</p>
						</p>
					</a>
				</li>
					<?php }else{?>
				&lt;!&ndash;这是问题&ndash;&gt;
				<li>
					<a href="index.php?m=Home&c=DirectTrain&a=specialColumnDetails&id=<?php echo $itemColumn['id']?>" class="searchBoxList">
						<div class="text-center mt20">
							<p class="subject">
								<?php if($itemColumn['code'] == 'yw'){?>
								<img src="__PUBLIC__/img/directTrain/yuwen.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'SX'){?>
								<img src="__PUBLIC__/img/directTrain/shuxue.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'YY'){?>
								<img src="__PUBLIC__/img/directTrain/yingyu.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'WL'){?>
								<img src="__PUBLIC__/img/directTrain/wuli.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'HX'){?>
								<img src="__PUBLIC__/img/directTrain/huaxue.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'ZZ'){?>
								<img src="__PUBLIC__/img/directTrain/sixiangzhengzhi.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'LS'){?>
								<img src="__PUBLIC__/img/directTrain/lishi.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'DL'){?>
								<img src="__PUBLIC__/img/directTrain/di.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'SW'){?>
								<img src="__PUBLIC__/img/directTrain/shengwu.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'MS'){?>
								<img src="__PUBLIC__/img/directTrain/meishu.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'TYJK'){?>
								<img src="__PUBLIC__/img/directTrain/tiyujiankang.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'LDJS'){?>

								<?php }elseif($itemColumn['code'] == 'XXJS'){?>

								<?php }elseif($itemColumn['code'] == 'YJPJ'){?>

								<?php }elseif($itemColumn['code'] == 'kx'){?>
								<img src="__PUBLIC__/img/directTrain/kexue.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'QXK'){?>

								<?php }elseif($itemColumn['code'] == 'PDYSH'){?>

								<?php }elseif($itemColumn['code'] == 'SXPD'){?>

								<?php }elseif($itemColumn['code'] == 'SXZZ'){?>
								<img src="__PUBLIC__/img/directTrain/sixiangzhengzhi.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'YX'){?>
								<img src="__PUBLIC__/img/directTrain/yin.png" alt="" /class="mr5 top1">
								<?php }elseif($itemColumn['code'] == 'SF'){?>

								<?php }elseif($itemColumn['code'] == 'TYJS'){?>
								<img src="__PUBLIC__/img/directTrain/tongyongjishu.png" alt="" /class="mr5 top1">
								<?php }?>
								<?php echo $itemColumn['course_name'].$itemColumn['grade'];?>
								<?php if($itemColumn['fascicule_id'] == 1){?>
								上册
								<?php }elseif($itemColumn['fascicule_id'] == 2){?>
								下册
								<?php }else{?>
								全一册
								<?php }?>
							</p>
						</div>
						<p class="searchTitle">
							<?php echo $itemColumn['special_column_question_title']?>
						</p>
						<p class="color666 text-center">
							时间：<?php echo $itemColumn['putaway_status_time']?>
						</p>
						<p class="text-center headPortrait">
							<img src="<?php echo !empty($itemColumn['avatar']) ?  $oss_path.$itemColumn['avatar'] : '/Public/img/classManage/teacher_m.png'?>" alt="" / >
						</p>

						<p class="text-center color666">
							  提问者:<?php echo $itemColumn['name']?>
						</p>
						<p class="watch of">
							<span class="left ml10">已有：<?php echo $itemColumn['special_column_question_visit_count']?>人观看</span>
							<span class="right mr10 "><img src="__PUBLIC__/img/directTrain/wenda2.png" alt="" /><?php echo $itemColumn['count']?>个回复</span>
						</p>
					</a>
				</li>
					<?php }?>
				<?php }?>
			</ul>-->
			<include file="./Application/Home/View/DirectTrain/iframe.html" />
		</div>

	</div>
</div>
<script type="text/javascript">
	$(function(){
		$(':radio').removeAttr('checked')
	})
    $('.leftNav').children('ul').children('li').hover(function () {
        $(this).addClass('leftNavLi')
        $(this).children('.navSubject').css('color','#e9573f')
        $(this).children('.navBox').show()
    }, function () {
        $(this).removeClass('leftNavLi')
        $(this).children('.navSubject').css('color','#333')
        $(this).children('.navBox').hide();
        $(this).find('.active').removeClass('active');
        // delete dataArr["grade_id"];
        // delete dataArr["fascicule_id"];
        // delete dataArr["editor"];
    });

    /****************************************************************************************************************/


		$('.free').click(function(){

			if($(this).attr('checked') == 'checked'){
	                $(this).removeAttr('checked');
	            $(this).attr('checked',false)
	            delete dataArr["isGratis"];
			}else {
	            $(this).attr('checked','checked');
	            $('.charge,.purchased').attr('checked',false)
	            dataArr["isGratis"] = 'isGratis';
	            delete dataArr["isToll"];
	            delete dataArr["isPurchased"];
			}
	        request();
			console.log(dataArr);

		})
		$('.charge').click(function(){
			if($(this).attr('checked') == 'checked'){
	            $(this).removeAttr('checked');
	            $(this).attr('checked',false)
	            delete dataArr["isToll"]
			}else {
	            $(this).attr('checked','checked');
	            $('.free,.purchased').attr('checked',false)
	            dataArr["isToll"] = 'isToll';
	            delete dataArr["isGratis"];
	            delete dataArr["isPurchased"];
			}
	        request();
			console.log(dataArr);

		})
		$('.purchased').click(function(){
	        if($(this).attr('checked') == 'checked'){
	            $(this).removeAttr('checked');
	            $(this).attr('checked',false)
	            delete dataArr["isPurchased"]
	        }else {
	            $(this).attr('checked','checked');
	            $('.free,.charge').attr('checked',false)
	            dataArr["isPurchased"] = 'isPurchased';
	            delete dataArr["isGratis"];
	            delete dataArr["isToll"];
	        }
			request();
		})
    /****************************************************************************************************************/


    /*点击默认等操作*/
    var dataArr = {};
    $('.sort').click(function () {
		$(this).addClass('active').siblings('.sort').removeClass('active')
        if ($(this).attr('class').indexOf('xia') != '-1') {
            $(this).removeClass('xia').addClass('shang');

            switch ($(this).index()) {
                case 0:
                    dataArr['isDefault'] = 'asc';
                    delete dataArr["isNew"];
                    delete dataArr["isHot"];
                    delete dataArr["isPrice"];
                    break;

                case 1:
                    dataArr['isNew'] = 'asc';
                    delete dataArr["isDefault"];
                    delete dataArr["isHot"];
                    delete dataArr["isPrice"];
                    break;

                case 2:
                    dataArr['isHot'] = 'asc';
                    delete dataArr["isDefault"];
                    delete dataArr["isNew"];
                    delete dataArr["isPrice"];
                    break;

                case 3:
                    dataArr['isPrice'] = 'asc';
                    delete dataArr["isDefault"];
                    delete dataArr["isNew"];
                    delete dataArr["isHot"];
                    break;

            }
            console.log(dataArr);
        } else {
            $(this).addClass('xia');
            $(this).siblings('.sort').removeClass('xia');
            $(this).siblings('.sort').removeClass('shang');
            switch ($(this).index()) {
                case 0:
                    dataArr['isDefault'] = 'desc';
                    delete dataArr["isNew"];
                    delete dataArr["isHot"];
                    delete dataArr["isPrice"];
                    break;

                case 1:
                    dataArr['isNew'] = 'desc';
                    delete dataArr["isDefault"];
                    delete dataArr["isHot"];
                    delete dataArr["isPrice"];
                    break;

                case 2:
                    dataArr['isHot'] = 'desc';
                    delete dataArr["isDefault"];
                    delete dataArr["isNew"];
                    delete dataArr["isPrice"];
                    break;

                case 3:
                    dataArr['isPrice'] = 'desc';
                    delete dataArr["isDefault"];
                    delete dataArr["isNew"];
                    delete dataArr["isHot"];
                    break;

            }
            console.log(dataArr);

        }
        request();

    });
    var grade_id = '' ;
    var fascicule_id ='';
    var editor = '';
    var course_id = '';
    $('.grade').children('span').click(function(){
        $(this).addClass('active').siblings('span').removeClass('active active1');
    })
    $('.fascicule').children('span').click(function(){
        $(this).addClass('active').siblings('span').removeClass('active active1');
    })
    $('.editor').children('span').click(function(){
        $(this).addClass('active').siblings('span').removeClass('active active1');
    })
    $('.determine').click(function(){
        $(this).parents('.navBox').find('.active').addClass('active1').end().parent().siblings().find('.active1').removeClass('active1')
        dataArr['editor'] = editor;
        dataArr['fascicule_id'] = fascicule_id ;
        dataArr['grade_id'] = grade_id ;
        course_id = $(this).parents('.navBox').siblings('.navSubject').attr('attr-value');
        grade_id = $(this).parent().siblings('.grade').find('.active,.active1').attr('attr-value');
        fascicule_id = $(this).parent().siblings('.fascicule').find('.active,.active1').attr('attr-value');
        editor_id =  $(this).parent().siblings('.editor').find('.active,.active1').attr('attr-value');
		$(this).parents('.navBox').siblings('.navSubject').addClass('actives').parent().siblings('li').find('.actives').removeClass('actives')
        dataArr['course_id'] = course_id;
        dataArr['fascicule_id'] = fascicule_id;
        dataArr['grade_id'] = grade_id ;
        dataArr['editor'] = editor_id;


        $('.navBox').hide();
        request();
        console.log(dataArr);
    });
    $('.navSubject').click(function(){

        $(this).addClass('actives').parent().siblings('li').find('.actives').removeClass('actives');
        dataArr['course_id'] = $(this).attr('attr-value');
        delete dataArr["fascicule_id"];
        delete dataArr["grade_id"];
        delete dataArr["editor"];
        request();
        console.log(dataArr);
    });
    /****************************************************************************************************************/
    function request() {
        var search = JSON.stringify(dataArr);
        var keyword = "<?php echo $_GET['keyword']?>";
        $.ajax({
            data:{'searchData':search,'keyword':keyword,'zoneBit':1,'ajaxType':'search'},
            url:'{:U("DirectTrain/getAjaxSearchData")}',
            type:'GET',
            success:function (data) {
                $('.searchList').html(data);
                $("html,body").animate({scrollTop:0}, 300);
            }
        })
    }
    function callback(data) {
        var arr = data.split("&p=");
        //console.log(arr);return false;
        return_ajax(arr[1]);
    }
    function return_ajax($page) {
        if($page){
            var page = $page;
        }
        var keyword = "<?php echo $keyword ;?>";
        var search = JSON.stringify(dataArr);
        //console.log(temp_arr);return false;
        $.ajax({
            url: '/index.php?m=Home&c=DirectTrain&a=getAjaxSearchData',
            type: 'GET',
            //dataType: 'json',
            data:{'p':page,'keyword':keyword,'type':'search','zoneBit':1,'searchData':search},
            success: function (data) {
                $('.searchList').html(data);
                $("html,body").animate({scrollTop:0}, 300);
            },
            error: function () {
                alert('cuo');
            }
        });
    }
</script>
<script>
    function search()
    {
        window.location.href = 'index.php?m=Home&c=DirectTrain&a=searchResultList&keyword=' + $('.search_text').val();
    }
    $(".search_text").keydown(function (evt) {
        if (event.keyCode == "13") { //keyCode=13是回车键
            search();
        }
    });
    $('.search_btn').click(function(){
        search();
    });
</script>
