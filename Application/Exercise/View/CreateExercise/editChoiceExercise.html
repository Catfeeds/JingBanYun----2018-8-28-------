<layout name="admin_layout_exercise"/>
<script type="text/javascript" src="__PUBLIC__/adminExercise/js/new_ueditor/ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="__PUBLIC__/adminExercise/js/new_ueditor/ueditor/ueditor.all.js"></script>
<script type="text/javascript" src="__PUBLIC__/adminExercise/js/vue.js"></script>
<script type="text/javascript" src="__PUBLIC__/adminExercise/js/vue-resource.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/adminExercise/js/exerciseNotify.js"></script>

<div class="boxOutter" id="app" v-cloak>

	<div class="">
        <include file="CreateExercise:editheader" />
				<div class="ml62">
					<span >选项数量</span>
					<select class="exerciseNums selectSize" name="" onchange="optionShow(this)">
                         <option <if condition="($exercise_info['num'] eq 2)">selected</if> value="2">2</option>
                         <option <if condition="($exercise_info['num'] eq 3)">selected</if> value="3">3</option>
                         <option <if condition="($exercise_info['num'] eq 4)">selected</if> value="4">4</option>
                         <option <if condition="($exercise_info['num'] eq 5)">selected</if> value="5">5</option>
                         <option <if condition="($exercise_info['num'] eq 6)">selected</if> value="6">6</option>
                         <option <if condition="($exercise_info['num'] eq 7)">selected</if> value="7">7</option>
                         <option <if condition="($exercise_info['num'] eq 8)">selected</if> value="8">8</option>
					</select>
				    <div class="mt10 editors db">
						<span class="textSpan optionSpan left">A</span>
						 <div style="width: 580px;" class="dib left mr10">
									<script type="text/plain" id="messageA" name="message" style="width:100%;height:50px;"></script>
						 </div>
						 <button type="button" name="button" answer_id="A" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'A') !== false? 'active':'' ?>">设为答案</button>
						 <button type="button" name="button" class="btn textSpan Deselect">取消设置</button>
						 <br>
						 <div class="dib left mt10 red dn">
							 *该项不可为空
						 </div>
						<div class="dib left mt10 red dn">
							*请选择答案
						</div>
					</div>
					<div class="mt10 editors db">
						 <span class="textSpan optionSpan left">B</span>
							<div style="width: 580px;" class="dib left mr10">
									 <script type="text/plain" id="messageB" name="message" style="width:100%;height:50px;"></script>
							</div>
							<button type="button" name="button" answer_id="B" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'B') !== false? 'active':'' ?>">设为答案</button>
							<button type="button" name="button" class="btn textSpan Deselect">取消设置</button>
							<br>
							<div class="dib left mt10 red dn">
								*该项不可为空
							</div>
                    </div>
					 <div class="mt10 editors db">
                        <span class="textSpan optionSpan left">C</span>
                             <div style="width: 580px;" class="dib left mr10">
                                        <script type="text/plain" id="messageC" name="message" style="width:100%;height:50px;"></script>
                             </div>
                             <button type="button" name="button" answer_id="C" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'C') !== false? 'active':'' ?>">设为答案</button>
                             <button type="button" name="button" class="btn textSpan Deselect">取消设置</button>
                             <br>
                             <div class="dib left mt10 red dn">
                                 *该项不可为空
                             </div>
                        </div>
						    <div class="mt10 editors db">
							 <span class="textSpan optionSpan left">D</span>
								<div style="width: 580px;" class="dib left mr10">
										 <script type="text/plain" id="messageD" name="message" style="width:100%;height:50px;"></script>
								</div>
								<button type="button" name="button" answer_id="D" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'D') !== false? 'active':'' ?>">设为答案</button>
								<button type="button" name="button" class="btn textSpan Deselect">取消设置</button>
								<br>
								<div class="dib left mt10 red dn">
									*该项不可为空
								</div>
						    </div>
						    <div class="mt10 editors dn">
								<span class="textSpan optionSpan left">E</span>
								 <div style="width: 580px;" class="dib left mr10">
											<script type="text/plain" id="messageE" name="message" style="width:100%;height:50px;"></script>
								 </div>
								 <button type="button" name="button" answer_id="E" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'E') !== false? 'active':'' ?>">设为答案</button>
								 <button type="button" name="button" class="btn textSpan Deselect">取消设置</button>
								 <br>
								 <div class="dib left mt10 red dn">
									 *该项不可为空
								 </div>
							</div>
							<div class="mt10 editors dn">
								 <span class="textSpan optionSpan left">F</span>
									<div style="width: 580px;" class="dib left mr10">
						 					<script type="text/plain" id="messageF" name="message" style="width:100%;height:50px;"></script>
						 		 </div>
									<button type="button" name="button"  answer_id="F" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'F') !== false? 'active':'' ?>">设为答案</button>
									<button type="button" name="button" class="btn textSpan Deselect">取消设置</button>
									<br>
									<div class="dib left mt10 red dn">
										*该项不可为空
									</div>
							 </div>
							 <div class="mt10 editors dn">
									<span class="textSpan optionSpan left">G</span>
									 <div style="width: 580px;" class="dib left mr10">
												<script type="text/plain" id="messageG" name="message" style="width:100%;height:50px;"></script>
									 </div>
									 <button type="button" name="button" answer_id="G" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'G') !== false? 'active':'' ?>">设为答案</button>
									 <button type="button" name="button" class="btn textSpan Deselect">取消设置</button>
									 <br>
									 <div class="dib left mt10 red dn">
										 *该项不可为空
									 </div>
								</div>
								<div class="mt10 editors dn">
									 <span class="textSpan optionSpan left">H</span>
										<div style="width: 580px;" class="dib left mr10">
							 					<script type="text/plain" id="messageH" name="message" style="width:100%;height:50px;"></script>
							 		 </div>
										<button type="button" name="button" answer_id="H" class="btn textSpan setAnswer <?= strpos($exercise_info['right_key'],'H') !== false? 'active':'' ?>" >设为答案</button>
										<button type="button" name="button" class="btn textSpan Deselect" >取消设置</button>
										<br>
										<div class="dib left mt10 red dn">
											*该项不可为空
										</div>
								 </div>
				</div>

				<div class="text-center mtb10">
					<button type="button" name="button" class="btn pl20 pr20 preview" onclick="preview(this)">预览</button>
				</div>

				<div class="mtb10">
					<span class="color3baeabFixed w64 mr0">分数</span>
                    <input type="number" class="Fractiondata inputCommon" value="{$exercise_info.score}">
						<span class="red dn">*格式不正确请重新输入</span>

				</div>
				<div class="mtb10">
					<div class="borderBottom">
							<p  class="tabBtn pl20 pr20 text-center">解析</p>
							<div class="dib  mt10 red dn">
								*该项不可为空
							</div>
					</div>
					<div class="mt10 mb10">
						<script type="text/plain" id="messageJx" name="message" style="width:90%;height:150px;">{$exercise_info.analysis|html_entity_decode}</script>

					</div>
					<button type="button" name="button" class="btn textSpan" onclick="preview(this)">整体预览</button>
					<button type="button" name="button" class="btn textSpan addExercise">修改习题</button>
					<button type="button" name="button" class="btn textSpan Canceloperation">取消操作</button>
				</div>
			</li>
			</ul>
	</div>
	<div class="borderBottom">
		<span class="text-center tabBtn">试题追踪</span>
	</div>
	<table class="tableCommon borderNone mt20">
		<thead>
		<tr>
			<th width="20%">序号</th>
			<th width="20%">操作</th>
			<th width="20%">操作人</th>
			<th width="20%">时间</th>
			<th width="20%">备注</th>
		</tr>
		</thead>
		<tbody>
		<?php foreach ($exercise_info['track'] as $trackK => $trackV): ?>
		<tr>
			<td><?=$trackK+1?></td>
			<td><?=$trackV['oper_name']?></td>
			<td><?=$trackV['operator_name']?></td>
			<td><?=$trackV['oper_time']?></td>
			<td class="showDetails"><a href="javascript:"><?=$trackV['comment']?></a></td>
		</tr>
		<?php endforeach ?>
		</tbody>
	</table>
</div>
<div class="exercise_choice dn">
	<div class="exerciseTitle">
		<p class="box1000 mt20">

			<button type="button" name="button" class="btn right mr0 answer4">所有选项一行</button>
			<button type="button" name="button" class="btn right answer2">每行两个选项</button>
			<button type="button" name="button" class="btn right answer1">每行一个选项</button>
		</p>
		<div class="exerciseTemplate">
			<div class="p15 pb0">
				<span class="score"></span>
				<span class="caption"></span>
			</div>
			<ul class="borderBottomEEE exerciseContent ">
				<li style="display:none"></li>
				<li style="display:none"></li>
				<li style="display:none"></li>
				<li style="display:none"></li>
				<li style="display:none"></li>
				<li style="display:none"></li>
				<li style="display:none"></li>
				<li style="display:none"></li>
			</ul>
			<div class="exerciseAnswer">
				<span class="color3baeab">【答案】</span>
				<span class="solution"></span>
			</div>
			<div class="exerciseJx">
				<span class="color3baeab">【解析】</span>
				<span class="analysisSpan"></span>
			</div>
			<div class="difficulty">
				<span >难度：</span>
				<span class="">

				</span>
			</div>
		</div>
	</div>
</div>
<div class="daan" style="display: none;">{$exercise_info.answer}</div>
<input type="hidden" name="repeat_commit" class="repeat_commit" value="{:session('TOKEN')}">
<input type="hidden" class="_send_paperid" value="{$paper_id}">
<input type="hidden" class="nextE" value="{$NextE.id}">

<script src="__PUBLIC__/adminExercise/js/input/loading.js"></script>
<script>
		var ueMessage = UE.getEditor('message');
		var messageA = UE.getEditor('messageA');
		var messageB = UE.getEditor('messageB');
		var messageC = UE.getEditor('messageC');
		var messageD = UE.getEditor('messageD');
		var messageE = UE.getEditor('messageE');
		var messageF = UE.getEditor('messageF');
		var messageG = UE.getEditor('messageG');
		var messageH = UE.getEditor('messageH');
		var messageJx = UE.getEditor('messageJx');

		var arr = new Array();
		arr[0] = 'A';
		arr[1] = 'B';
		arr[2] = 'C';
		arr[3] = 'D';
		arr[4] = 'E';
		arr[5] = 'F';
		arr[6] = 'G';
		arr[7] = 'H';
		var num = "{$exercise_info.num}";
		var answer = $('.daan').html();
		answer = answer.split('jingbanyunxx');


		for(var i=0; i< num;i++) {
			var testVar = null;
			eval('testVar=message'+arr[i]);
			testVar.data =  answer[i];
			testVar.ready(function() {
				this.setContent(this.data);
			});
		}

		var answerWidth = "{$exercise_info.class_type}"

		//试题审核时需要的
		function checkHtml(){
			$('.preview').bind('click').click()
			return $('.exercise_choice').html()
		}
</script>

<script type="text/javascript" src="__PUBLIC__/adminExercise/js/input/editinput.js"></script>
<script type="text/javascript" src="__PUBLIC__/adminExercise/js/newRender.js"></script>
<script>
	optionShow('.exerciseNums');
</script>
